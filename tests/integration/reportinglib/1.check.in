#! /bin/sh

#NOTE: binary diff is not a good idea as it dont reflect what people use to read reports

OK=0
FAILED=1

if [ -f test_1.bbp ] && [ -f test_2 ]
then
   #checking something with @reportinglib_BIN_DIR@/dump test_1.bbp
   # for ascii files that will be using grep for instance.
   nb_recorded=$(@reportinglib_LIB_DIR@/../bin/somaDump test_1.bbp 1| wc -l)
   nb_recorded_sonata=$(h5dump -d /report/data -y -O test_2| wc -l)
   # 101 because a white space
   if [ $nb_recorded -eq 100 ] && [ $nb_recorded_sonata -eq 101 ]; then
     exit $OK
   else
     echo "[ERROR] The number of steps recorded doesn't match. Test failed!" >&2
     exit $FAILED
   fi
else
   echo "[ERROR] Soma report file doesn't exist. Test failed!" >&2
   exit $FAILED
fi

